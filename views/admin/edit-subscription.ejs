<!DOCTYPE html>
<html lang="en">
    <head>
        <meta charset="utf-8">
        <meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=0">
        <title>Ecardify - Dashboard</title>
		
		<!-- Favicon -->
        <link rel="shortcut icon" href="/public/assets/admin/img/favicon.png">
		
		<!-- Fontfamily -->
		<link href="https://fonts.googleapis.com/css2?family=Roboto:ital,wght@0,400;0,500;0,700;0,900;1,400;1,500;1,700&display=swap" rel="stylesheet">
		
		<!-- Bootstrap CSS -->
        <link rel="stylesheet" href="/public/assets/admin/plugins/bootstrap/css/bootstrap.min.css">
		
		<!-- Feathericon CSS -->
        <link rel="stylesheet" href="/public/assets/admin/plugins/feather/feather.css">
		
		<!-- Pe7 CSS -->
		<link rel="stylesheet" href="/public/assets/admin/plugins/icons/flags/flags.css">
		
		<!-- Fontawesome CSS -->
		<link rel="stylesheet" href="/public/assets/admin/plugins/fontawesome/css/fontawesome.min.css">
		<link rel="stylesheet" href="/public/assets/admin/plugins/fontawesome/css/all.min.css">
		
		<!-- Main CSS -->
        <link rel="stylesheet" href="/public/assets/admin/css/style.css">
    </head>
    <body>
		
		<!-- Main Wrapper -->
        <div class="main-wrapper">
		
			<!-- Header -->
           <%- include('header.ejs') %>
			<!-- /Header -->
			
			<!-- Sidebar -->
				<%- include('sidebar.ejs') %>
			<!-- /Sidebar -->
			
			<!-- Page Wrapper -->
            <div class="page-wrapper">
                <div class="content container-fluid">
				
					<!-- Page Header -->
					<div class="page-header">
						<div class="row align-items-center">
							<div class="col">
								<h3 class="page-title">Edit subscriptiion</h3>
								<ul class="breadcrumb">
									<li class="breadcrumb-item"><a href="/subscription">subscription plan </a></li>
									<li class="breadcrumb-item active"> edit subscription</li>
								</ul>
							</div>
						</div>
					</div>
					<!-- //Page Header -->
				
					<div class="row">
						<div class="col-sm-12">
						
							<div class="card">
								<div class="card-body">
									<form action="/edit-subscription/<%- plan.id %>" method="post">
										<div class="row">
											<div class="col-12">
												<h5 class="form-title"><span>Basic Details</span></h5>
											</div>
											<div class="col-12 col-sm-4">
												<div class="form-group local-forms">
													<label>plan Name <span class="login-danger">*</span></label>
													<input name="name" value="<%= plan.name %>" class="form-control" type="text" placeholder="Edit plan Name" required>
												</div>
											</div>
								
											<div class="col-12 col-sm-4">  
												<div class="form-group local-forms">
													<label>Price<span class="login-danger">*</span></label>
													<input name="price" value="<%= plan.price %>" class="form-control" type="num" placeholder="Edit price" required>
												</div>
											</div>
										</div>
											<div class="row">
												<div class="col-12">
													<h5 class="form-title"><span>Existing Features</span></h5>
												</div>
												
													<div class="col-12">
														<div class="form-group">
															<label>Feature Name<span class="login-danger">*</span></label>
															<input name="existingFeatures" id="existingFeatures" class="form-control" type="text" value="<%= plan.features ? plan.features.join(', ') : '' %>" >
															
														</div>
														
													</div>
												
											</div>
										
								
										
								
										
										
										<div class="row">
											<div class="col-12 button-container">
												<div class="student-submit">
													<button name="submit" type="submit" class="btn btn-primary">Update Subscription</button>
												</div>
											</div>
										</div>
									</form>
								</div>
							</div>
						</div>					
					</div>					
				</div>
				
			</div>
			<!-- /Page Wrapper -->


		<!-- /Main Wrapper -->
		
		<!-- jQuery -->

		<style>
			.button-container {
			  margin-bottom: 15px; /* Add some margin between buttons */
			}
		  </style>


<script>
	document.addEventListener('DOMContentLoaded', function () {
	  const form = document.getElementById('subscriptionForm');
	  const additionalFeaturesContainer = document.getElementById('additionalFeatures');
	  const addFeatureBtn = document.getElementById('addFeature');
  
	  function registerDeleteButtons() {
		const deleteButtons = document.querySelectorAll('.delete-feature-btn');
		deleteButtons.forEach(button => {
		  button.addEventListener('click', function () {
			this.closest('.row').remove();
		  });
		});
	  }
  
	  addFeatureBtn.addEventListener('click', function () {
		additionalFeaturesContainer.innerHTML += `
		  <div class="row">
			<div class="col-12">
			  <div class="form-group">
				<label>Feature Name<span class="login-danger">*</span></label>
				<input name="existingFeatures[]" class="form-control" type="text" placeholder="Enter Feature Name" required>
			  </div>
			</div>
			<div class="col-12 col-sm-4 button-container">
			  <button type="button" class="delete-feature-btn">Delete</button>
			</div>
		  </div>
		`;
  
		registerDeleteButtons(); // Register event listeners for newly added delete buttons
	  });
  
	  form.addEventListener('submit', function (event) {
		event.preventDefault();
  
		// Process the form data, e.g., send it to the server using AJAX
		const formData = new FormData(form);
		// ... Perform the necessary actions ...
  
		// Reset the form or redirect the user as needed
		form.reset();
	  });
  
	  // Delegate the event handling to a parent container (use the closest common parent)
	  additionalFeaturesContainer.addEventListener('click', function (event) {
		if (event.target.classList.contains('delete-feature-btn')) {
		  event.target.closest('.row').remove();
		}
	  });
  
	  // Register initial delete buttons
	  registerDeleteButtons();
	});
  </script>
         
		 


        <script src="/public/assets/admin/js/jquery-3.6.0.min.js"></script>
		
		<!-- Bootstrap Core JS -->
        <script src="/public/assets/admin/plugins/bootstrap/js/bootstrap.bundle.min.js"></script>
		
		<!-- Feather Icon JS -->
		<script src="/public/assets/admin/js/feather.min.js"></script>
		
		<!-- Slimscroll JS -->
		<script src="/public/assets/admin/plugins/slimscroll/jquery.slimscroll.min.js"></script>
		
		<!-- Datepicker Core JS -->
		<script src="/public/assets/admin/plugins/moment/moment.min.js"></script>
		<script src="/public/assets/admin/js/bootstrap-datetimepicker.min.js"></script>

		<!-- Select2 JS -->
		<script src="/public/assets/admin/plugins/select2/js/select2.min.js"></script>
		
		<!-- Custom JS -->
		<script src="/public/assets/admin/js/script.js"></script>
    </body>
</html>